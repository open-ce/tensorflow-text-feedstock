From dd588ef19b86e780f0b7931890f940699ba4170e Mon Sep 17 00:00:00 2001
From: Nishidha Panpaliya <npanpa23@in.ibm.com>
Date: Tue, 18 Apr 2023 02:47:41 -0400
Subject: [PATCH] Fix jpeg in Tensorflow

---
 WORKSPACE                                   |  2 ++
 third_party/tensorflow/fix-jpeg-in-tf.patch | 24 +++++++++++++++++++++
 2 files changed, 26 insertions(+)
 create mode 100644 third_party/tensorflow/fix-jpeg-in-tf.patch

diff --git a/WORKSPACE b/WORKSPACE
index 28b7ee5..c41d42b 100644
--- a/WORKSPACE
+++ b/WORKSPACE
@@ -75,6 +75,8 @@ http_archive(
     urls = [
         "https://github.com/tensorflow/tensorflow/archive/v2.12.0.zip"
     ],
+    patches = ["//third_party/tensorflow:fix-jpeg-in-tf.patch"],
+    patch_args = ["-p1"],
 )
 
 http_archive(
diff --git a/third_party/tensorflow/fix-jpeg-in-tf.patch b/third_party/tensorflow/fix-jpeg-in-tf.patch
new file mode 100644
index 0000000..6831074
--- /dev/null
+++ b/third_party/tensorflow/fix-jpeg-in-tf.patch
@@ -0,0 +1,24 @@
+From 33b9f80d0d6af439f237a4e3a7b8b591d3a09444 Mon Sep 17 00:00:00 2001
+From: Nishidha Panpaliya <npanpa23@in.ibm.com>
+Date: Mon, 17 Apr 2023 05:34:21 -0400
+Subject: [PATCH] Fixed jpeg build on Power
+
+---
+ third_party/jpeg/jpeg.BUILD | 1 +
+ 1 file changed, 1 insertion(+)
+
+diff --git a/third_party/jpeg/jpeg.BUILD b/third_party/jpeg/jpeg.BUILD
+index 8b3f9f0b401..4549491ac4d 100644
+--- a/third_party/jpeg/jpeg.BUILD
++++ b/third_party/jpeg/jpeg.BUILD
+@@ -142,6 +142,7 @@ cc_library(
+     srcs = [
+         "jchuff.h",
+         "jconfig.h",
++        "jconfigint.h",
+         "jdct.h",
+         "jerror.h",
+         "jinclude.h",
+-- 
+2.31.1
+
-- 
2.31.1

